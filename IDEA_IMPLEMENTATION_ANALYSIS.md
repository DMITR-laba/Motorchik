# –ê–Ω–∞–ª–∏–∑ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–¥–µ–∏ –∏–∑ idea.md

## üìã –û–±–∑–æ—Ä –∏–¥–µ–∏

–í —Ñ–∞–π–ª–µ `idea.md` –æ–ø–∏—Å–∞–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ò–ò-–∞–≥–µ–Ω—Ç–∞ —Å –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç—å—é, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è:
- **Mem0** –¥–ª—è –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏
- **LangGraph** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —á–µ—Ä–µ–∑ –≥—Ä–∞—Ñ
- **RAG —Å –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ–º** (FlashrankRerank + ContextualCompressionRetriever)
- **–í–µ–±-—Å–∫—Ä–∞–ø–µ—Ä** –¥–ª—è –Ω–æ–≤–æ—Å—Ç–µ–π (Seeking Alpha, Yahoo Finance, Investing.com)
- **FAISS** –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- **OpenAI –º–æ–¥–µ–ª–∏** (gpt-4o, text-embedding-3-small)

---

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –î–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å (—á–∞—Å—Ç–∏—á–Ω–æ)

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ **Redis** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞ (`DialogueHistoryService`)
- ‚úÖ **MemoryManagerService** –¥–ª—è —Å–∂–∞—Ç–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é
- ‚úÖ **DialogStateService** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –¥–∏–∞–ª–æ–≥–∞
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –≤ Redis —Å fallback –Ω–∞ in-memory —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

**–û—Ç–ª–∏—á–∏—è –æ—Ç –∏–¥–µ–∏:**
- ‚ùå **Mem0 –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** - –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∫–∞—Å—Ç–æ–º–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Redis
- ‚ùå –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ (–∫–∞–∫ –≤ Mem0)
- ‚ùå –ù–µ—Ç –≥—Ä–∞—Ñ–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–∞–º—è—Ç–∏ (–∫–∞–∫ –≤ Mem0)

**–§–∞–π–ª—ã:**
- `backend/services/dialogue_history_service.py`
- `backend/services/memory_manager_service.py`
- `backend/services/dialog_state_service.py`

### 2. RAG —Å–∏—Å—Ç–µ–º–∞

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ **RAGService** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- ‚úÖ –ü–æ–∏—Å–∫ –ø–æ —Å—Ç–∞—Ç—å—è–º, –¥–æ–∫—É–º–µ–Ω—Ç–∞–º –∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Elasticsearch –¥–ª—è –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ

**–û—Ç–ª–∏—á–∏—è –æ—Ç –∏–¥–µ–∏:**
- ‚ùå **–ù–µ—Ç –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è** (FlashrankRerank –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- ‚ùå **–ù–µ—Ç ContextualCompressionRetriever** –¥–ª—è —Å–∂–∞—Ç–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- ‚ùå –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫ –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏

**–§–∞–π–ª—ã:**
- `backend/services/rag_service.py`

### 3. –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ **VectorSearchService** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º pgvector (PGVector)
- ‚úÖ –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å PostgreSQL —á–µ—Ä–µ–∑ langchain-postgres
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ HuggingFace —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤

**–û—Ç–ª–∏—á–∏—è –æ—Ç –∏–¥–µ–∏:**
- ‚ùå **FAISS –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** - –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ PostgreSQL —Å pgvector
- ‚úÖ –≠—Ç–æ **–ª—É—á—à–µ** –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ (–ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)

**–§–∞–π–ª—ã:**
- `backend/services/vector_search_service.py`

### 4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ **DialogStateService** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ –ø–æ–∏—Å–∫–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
- ‚úÖ Redis –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å TTL

**–û—Ç–ª–∏—á–∏—è –æ—Ç –∏–¥–µ–∏:**
- ‚ùå **LangGraph –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** - –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –æ–±—ã—á–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚ùå –ù–µ—Ç —è–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π —Å —É–∑–ª–∞–º–∏ –∏ —Ä–µ–±—Ä–∞–º–∏
- ‚ùå –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —á–µ—Ä–µ–∑ —ç—Ç–∞–ø—ã (retrieve_memories ‚Üí retrieve_docs ‚Üí generate ‚Üí save)

**–§–∞–π–ª—ã:**
- `backend/services/dialog_state_service.py`

### 5. –í–µ–±-—Å–∫—Ä–∞–ø–µ—Ä

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚ùå **–ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** - –Ω–µ—Ç —Å–∫—Ä–∞–ø–µ—Ä–∞ –¥–ª—è –Ω–æ–≤–æ—Å—Ç–µ–π

**–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:**
- ‚ùå –§—É–Ω–∫—Ü–∏—è `fetch_seekingalpha_trending_news()`
- ‚ùå –ü–∞—Ä—Å–∏–Ω–≥ RSS-–ª–µ–Ω—Ç (Seeking Alpha, Yahoo Finance, Investing.com)
- ‚ùå –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–µ–π –≤ —Ñ–∞–π–ª—ã –¥–ª—è RAG

---

## üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞–º—è—Ç–∏

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```
DialogueHistoryService (Redis)
    ‚Üì
MemoryManagerService (—Å–∂–∞—Ç–∏–µ –∏—Å—Ç–æ—Ä–∏–∏)
    ‚Üì
DialogStateService (—Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞)
```

**–ò–¥–µ—è –∏–∑ idea.md:**
```
Mem0 (–≥—Ä–∞—Ñ–æ–≤–∞—è –ø–∞–º—è—Ç—å)
    ‚Üì
retrieve_memories() ‚Üí –¥–æ 50 —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
    ‚Üì
save_to_memory() ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
```

**–ü—Ä–æ–±–ª–µ–º—ã —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
1. –ù–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏ (—Ç–æ–ª—å–∫–æ –ø–æ –≤—Ä–µ–º–µ–Ω–∏)
2. –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π
3. –ù–µ—Ç –≥—Ä–∞—Ñ–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è–º–∏

### RAG —Å–∏—Å—Ç–µ–º–∞

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫ –±–µ–∑ –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è
articles = db_service.search_articles_for_rag(query, limit=10)
docs = doc_service.search_documents_for_rag(query, limit=10)
cars = db_service.search_cars_for_rag(query, limit=50)
```

**–ò–¥–µ—è –∏–∑ idea.md:**
```python
# –° –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ–º
reranker = FlashrankRerank(model="ms-marco-TinyBERT-L-2-v2", top_n=5)
compressed_retriever = ContextualCompressionRetriever(
    base_retriever=vs.as_retriever(search_kwargs={"k": 5}),
    base_compressor=reranker
)
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
1. –ù–µ—Ç –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
2. –ù–µ—Ç —Å–∂–∞—Ç–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤
3. –ü—Ä–æ—Å—Ç–æ–π –ª–∏–º–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –û–±—ã—á–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
rag_service.generate_response(...)
    ‚Üí intelligent_search.search_with_intelligence(...)
    ‚Üí vector_search.similarity_search(...)
```

**–ò–¥–µ—è –∏–∑ idea.md:**
```python
# LangGraph —Å —è–≤–Ω—ã–º –≥—Ä–∞—Ñ–æ–º
workflow = StateGraph(GraphState)
workflow.add_node("retrieve_memories", retrieve_memories)
workflow.add_node("retrieve_docs", retrieve_docs)
workflow.add_node("generate", generate_response)
workflow.add_node("save_memory", save_to_memory)
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
1. –ù–µ—Ç —è–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π
2. –ù–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∞–ø–æ–≤
3. –°–ª–æ–∂–Ω–µ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### 1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Mem0 (–≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π
- –ì—Ä–∞—Ñ–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–º—è—Ç–∏
- –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞
pip install mem0ai

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
from mem0 import Memory

memory = Memory()
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ
relevant_memories = memory.search(query=user_query, user_id=user_id, limit=50)
memory.add(history, user_id=user_id)
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- –ó–∞–º–µ–Ω–∏—Ç—å `DialogueHistoryService` –Ω–∞ Mem0
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∫–∞–∂–¥–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –≤ Mem0
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `memory.search()` –≤–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è (–≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –£–ª—É—á—à–µ–Ω–∏–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –°–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
- –ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
from langchain_community.document_compressors import FlashrankRerank
from langchain.retrievers import ContextualCompressionRetriever

# –í RAGService
reranker = FlashrankRerank(model="ms-marco-TinyBERT-L-2-v2", top_n=5)
compressed_retriever = ContextualCompressionRetriever(
    base_retriever=vector_store.as_retriever(search_kwargs={"k": 10}),
    base_compressor=reranker
)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
docs = compressed_retriever.invoke(query)
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å –≤ `RAGService.__init__()`
- –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ø–æ–∏—Å–∫–∞ –ø–æ —Å—Ç–∞—Ç—å—è–º, –¥–æ–∫—É–º–µ–Ω—Ç–∞–º –∏ –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: `pip install flashrank`

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è LangGraph (—Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –Ø–≤–Ω—ã–π –≥—Ä–∞—Ñ —Å–æ—Å—Ç–æ—è–Ω–∏–π
- –õ–µ–≥—á–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —É—Å–ª–æ–≤–Ω—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
from langgraph.graph import StateGraph, END
from typing import TypedDict

class GraphState(TypedDict):
    message: str
    user_id: str
    memories_str: str
    docs_ctx: str
    response: str

workflow = StateGraph(GraphState)
workflow.add_node("retrieve_memories", retrieve_memories)
workflow.add_node("retrieve_docs", retrieve_docs)
workflow.add_node("generate", generate_response)
workflow.add_node("save_memory", save_to_memory)

workflow.set_entry_point("retrieve_memories")
workflow.add_edge("retrieve_memories", "retrieve_docs")
workflow.add_edge("retrieve_docs", "generate")
workflow.add_edge("generate", "save_memory")
workflow.add_edge("save_memory", END)

graph = workflow.compile()
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- –û–±–µ—Ä–Ω—É—Ç—å —Ç–µ–∫—É—â–∏–π `RAGService.generate_response()` –≤ –≥—Ä–∞—Ñ
- –î–æ–±–∞–≤–∏—Ç—å —É–∑–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: `pip install langgraph`

### 4. –í–µ–±-—Å–∫—Ä–∞–ø–µ—Ä –¥–ª—è –Ω–æ–≤–æ—Å—Ç–µ–π (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
```python
import feedparser
import requests
from bs4 import BeautifulSoup

def fetch_seekingalpha_trending_news():
    feeds = [
        'https://seekingalpha.com/feed.xml',
        'https://feeds.finance.yahoo.com/rss/2.0/headline',
        'https://www.investing.com/rss/news.rss',
    ]
    
    articles = []
    for feed_url in feeds:
        feed = feedparser.parse(feed_url)
        articles.extend(feed.entries[:15])
    
    # –ü–∞—Ä—Å–∏–Ω–≥ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
    # ...
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- –°–æ–∑–¥–∞—Ç—å `backend/services/news_scraper_service.py`
- –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ (—á–µ—Ä–µ–∑ cron –∏–ª–∏ celery)
- –ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –≤ –≤–µ–∫—Ç–æ—Ä–Ω—É—é –ë–î

### 5. –£–ª—É—á—à–µ–Ω–∏–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π (—Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- –ò—Å—Ç–æ—Ä–∏—è –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–æ–æ–±—â–µ–Ω–∏–π)
- –ù–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –í DialogueHistoryService –¥–æ–±–∞–≤–∏—Ç—å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
def get_relevant_history(self, query: str, limit: int = 10) -> List[Dict]:
    """–ü–æ–ª—É—á–∞–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é –ø–æ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–º—É –ø–æ–∏—Å–∫—É"""
    all_messages = self.get_all_messages()
    
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
    from services.vector_search_service import VectorSearchService
    vector_service = VectorSearchService()
    
    # –°–æ–∑–¥–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏
    documents = [
        Document(page_content=msg["content"], metadata={"timestamp": msg["timestamp"]})
        for msg in all_messages
    ]
    
    # –ü–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö
    results = vector_service.similarity_search(query, k=limit)
    return [msg for msg, score in results]
```

---

## üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ò–¥–µ—è (idea.md) | –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è | –°—Ç–∞—Ç—É—Å |
|-----------|----------------|-------------------|--------|
| **–î–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å** | Mem0 | Redis + MemoryManagerService | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ |
| **–ì—Ä–∞—Ñ —Å–æ—Å—Ç–æ—è–Ω–∏–π** | LangGraph | –û–±—ã—á–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| **RAG –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ** | FlashrankRerank | –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫ | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| **–í–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ** | FAISS | PostgreSQL + pgvector | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–ª—É—á—à–µ) |
| **–í–µ–±-—Å–∫—Ä–∞–ø–µ—Ä** | RSS –ø–∞—Ä—Å–µ—Ä | - | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π** | –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ | –ü–æ –≤—Ä–µ–º–µ–Ω–∏ | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ |

---

## üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
1. **–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ** - –±—ã—Å—Ç—Ä–æ —É–ª—É—á—à–∏—Ç –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤
2. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Mem0** - —Ä–µ—à–∏—Ç –ø—Ä–æ–±–ª–µ–º—É –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
3. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å LangGraph** - —É–ª—É—á—à–∏—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ –æ—Ç–ª–∞–¥–∫—É
4. **–£–ª—É—á—à–∏—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏–π** - —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ –∏—Å—Ç–æ—Ä–∏–∏

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
5. **–î–æ–±–∞–≤–∏—Ç—å –≤–µ–±-—Å–∫—Ä–∞–ø–µ—Ä** - –µ—Å–ª–∏ –Ω—É–∂–Ω—ã –Ω–æ–≤–æ—Å—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ

---

## üìù –í—ã–≤–æ–¥—ã

**–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ:**
- ‚úÖ –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –Ω–∞ pgvector (–ª—É—á—à–µ FAISS –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
- ‚úÖ –ë–∞–∑–æ–≤–∞—è RAG —Å–∏—Å—Ç–µ–º–∞
- ‚úÖ –•—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –≤ Redis

**–ß—Ç–æ –Ω—É–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å:**
- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
- ‚ö†Ô∏è –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Mem0 –¥–ª—è –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏
- ‚ö†Ô∏è –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å LangGraph –¥–ª—è —è–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: 60%**
- –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –µ—Å—Ç—å
- –ù–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∫–ª—é—á–µ–≤—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏–∑ –∏–¥–µ–∏ (–ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ, Mem0, LangGraph)

